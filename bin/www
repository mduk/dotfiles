#!/bin/bash

case $# in
  0)
    if [[ -f $PWD/.www ]]
    then
      chromium-browser --app="$(cat $PWD/.www)" &
    else
      declare url=$(
        (
          find $HOME/.config/www/ -type f -printf "%f\n";
          cat $HOME/.config/www/*
        ) | dmenu -nb '#000' \
                  -fn "$DMENU_FONT" \
                  -p 'WWW>'
      )

      if [[ -z $url ]]
      then exit
      fi

      if [[ $url != http* ]]
      then declare url=$(cat $HOME/.config/www/$url)
      fi

      chromium-browser --app="$url"
    fi

    ;;

  1)
    declare url

    if [[ $1 == http* ]] || [[ $1 == file* ]]
    then url="$1"
    elif [[ -f "$HOME/.config/www/$1" ]]
    then url=$(cat "$HOME/.config/www/$1")
    else url="http://$1"
    fi

    chromium-browser --app="$url" &
    ;;

  2)
    echo "$2" > $HOME/.config/www/$1
    ;;

  *)
    echo "Usage:"
    echo "  www <alias>       - Open aliased address"
    echo "  www <alias> <url> - Set address alias"
    ;;
esac
